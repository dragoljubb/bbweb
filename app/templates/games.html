{% extends "layout.html" %}

{% block content %}

<h1>Games</h1>

<!-- ========================= -->
<!-- Filter bar -->
<!-- ========================= -->
<form method="get" class="filters">
    <!-- Season -->
    <select name="season" onchange="this.form.submit()">
        {% for s in seasons %}
            <option value="{{ s.code }}"
                {% if s.code == season %}selected{% endif %}>
                {{ s.label }}
            </option>
        {% endfor %}
    </select>

    <!-- Phase -->
    <select name="phase" onchange="this.form.submit()">
        {% for p in phases %}
            <option value="{{ p.phase }}"
                {% if p == phase %}selected{% endif %}>
                {{ p.phase }}
            </option>
        {% endfor %}
    </select>

    <!-- Team -->
    <select name="team" onchange="this.form.submit()">
        <option value="">All teams</option>
        {% for t in teams %}
            <option value="{{ t.code }}"
                {% if t.code == selected_team %}selected{% endif %}>
                {{ t.team_name }}
            </option>
        {% endfor %}
    </select>

    <!-- zadrÅ¾i round -->
    <input type="hidden" name="round" value="{{ selected_round }}">
</form>

<!-- ========================= -->
<!-- LEAGUE VIEW -->
<!-- ========================= -->
{% if mode == "LEAGUE" %}

<div class="round-slider">
    {% for r in rounds %}
        <a href="?season={{ season }}&round_type={{ phase }}&round={{ r.round }}">
            Round {{ r.round }}
        </a>
    {% endfor %}
</div>


<div class="round-games">
    {% if games %}
       {% for g in games %}
             {% include "components/game_card.html" %}
        {% endfor %}
    {% else %}
        <p>No games in this round.</p>
    {% endif %}
</div>

{% else %}

<!-- ========================= -->
<!-- TEAM VIEW -->
<!-- ========================= -->

<table class="table table-striped">
    <thead>
        <tr>
            <th>Date</th>
            <th>Home</th>
            <th>Away</th>
            <th>Status</th>
            <th>Score</th>
        </tr>
    </thead>
    <tbody>
        {% for g in games %}
            {% set row_class = "" %}
            {% if g.game_status == 'RESULT' %}
                {% set row_class = "table-success" %}
            {% elif g.game_status == 'NEXT' %}
                {% set row_class = "table-warning" %}
            {% elif g.game_status == 'UPCOMING' %}
                {% set row_class = "table-info" %}
            {% endif %}
            <tr class="{{ row_class }}">
                <td>{{ g.game_date.strftime('%d %b %Y') }}</td>
                <td>{{ g.home_code }}</td>
                <td>{{ g.away_code }}</td>
                <td>{{ g.game_status }}</td>
                <td>
                    {% if g.played %}
                        {{ g.home_score }} - {{ g.away_score }}
                    {% else %}
                        -
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

{% endif %}
{% endblock %}
