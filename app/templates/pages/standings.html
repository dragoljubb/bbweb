{% extends "pages/layout.html" %}
{% from "components/select.html" import filter_select %}
{% block content %}

<h2 class="mt-4 mb-3">Standings</h2>

<form method="get" class="game-filter row g-2 align-items-center">

  {{ filter_select(
      name="season",
      items=seasons,
      value_attr="code",
      label_attr="label",
      selected_value=selected_season,
      id="seasonSelect",
      col_class="col-md-2"
  ) }}

  {{ filter_select(
      name="round",
      items=rounds,
      value_attr="round",
      label_attr="label",
      selected_value=selected_round,
      id="roundSelect",
      col_class="col-md-2"
  ) }}

</form>


<table class="stats-table standings-table mt-4">

 <thead>
<tr>
    <th class="text-end">#</th>
    <th class="text-start team-col">Team</th>
    <th>GP</th>
    <th>W</th>
    <th>L</th>
    <th>PF</th>
    <th>PA</th>
    <th>+/-</th>
    <th>Home</th>
    <th>Away</th>
    <th>OT</th>
    <th>Last 5</th>
    <th>Last 10</th>
    <th>Win %</th>
    <th>Δ</th>
  </tr>
</thead>

<tbody>
{% for s in standings %}
<tr class="standings-row"
    data-href="{{ url_for('main_bp.team_details', team_code=s.team_code) }}?season={{ selected_season }}">

  <td class="text-end">{{ s.team_position }}</td>

  <td class="text-start team-col">
    <div class="team-cell">
      <img src="{{ team_logo(s.team_code) }}" alt="{{ s.team_name }}" class="team-logo">
      <span class="team-name">{{ s.team_name }}</span>
    </div>
  </td>

  <td>{{ s.games_played }}</td>
  <td>{{ s.games_won }}</td>
  <td>{{ s.games_lost }}</td>
  <td>{{ s.points_for }}</td>
  <td>{{ s.points_against }}</td>
  <td>{{ s.points_diff }}</td>
  <td>{{ s.home_record }}</td>
  <td>{{ s.away_record }}</td>
  <td>{{ s.overtime_record }}</td>

  <td class="last5">
    {% for r in s.last5_form %}
      {% if r == 'W' %}
        <span class="form form-win">W</span>
      {% elif r == 'L' %}
        <span class="form form-loss">L</span>
      {% else %}
        <span class="form">{{ r }}</span>
      {% endif %}
    {% endfor %}
  </td>

  <td>{{ s.last_ten_record }}</td>
  <td>{{ s.win_percentage }}%</td>

  <td>
    {% if s.position_change == 'Up' %}
      <span class="delta-up">▲</span>
    {% elif s.position_change == 'Down' %}
      <span class="delta-down">▼</span>
    {% else %}
      <span class="delta-equal">–</span>
    {% endif %}
  </td>

</tr>
{% endfor %}
</tbody>

</table>

{% endblock %}
